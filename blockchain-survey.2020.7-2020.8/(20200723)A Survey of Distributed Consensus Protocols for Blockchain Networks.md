[1]: [A Survey of Distributed Consensus Protocols for Blockchain Networks](https://arxiv.org/abs/1904.04098)

“【】”符号及数字表示此内容需要日后深入学习

## 主题

- 经典分布式容错理论中的关键定义和相关结论
- 定义区块链共识协议的 5 个核心组件：block proposal, block validation, information propagation, block finalization, and incentive mechanism.
- 对具体的共识协议进行算法抽象化和脆弱性分析，并根据不同的性能指标进行比较
- 根据上述分析和比较，清楚在这些具体的共识协议在应用场景、关键假设、预期容错、可扩展性、缺点及其权衡取舍几方面的不同

## 结构

1. 介绍
   1. 简略介绍区块链基本概念
   2. 阐述区块链带来的变革
   3. 说明初代区块链共识：中本聪共识/Pow 的缺点
   4. 分别对组件简要介绍，顺序与之前提出时不一致，且没有全部介绍：block proposing, incentive mechanisms, block finalization
   5. 做出的贡献：研究集中于性能、容错、安全
      1. 背景介绍，包括 BFT 的相关同步和异步协议
      2. 从 5 个组件方面回顾共识协议的设计哲学和安全性
      3. 将 PoS 分为 4 类，并抽象出每一类的通用算法
      4. 对于以上提到的共识协议，在 5 组件框架、容错和交易处理能力方面进行比较
      5. 给出一个在处于安全性、去中心化及扩展性的三难困境时如何设计共识协议的教程
   6. 介绍论文结构（如下文所示）
2. 回顾共识协议相关工作

   1. 对比 Pow 和 BFT 两种流派的 transaction throughput, scalability limits, consensus finality, and security implications 几方面，简单说明两者优缺点，
   2. 接着介绍并评价了相关论文所做的工作
3. 分布式系统下的经典容错协议背景，包括基于拜占庭容错设计的同步和异步共识协议：主要介绍分布式的消息传递系统

   1. 描述经典消息传递系统的系统模型，包括分布式系统和任务、进程错误和网络同步，介绍了 FLP impossibility，并提出这种不可能性可以通过动态决策和放宽终止属性来合理规避
   2. 介绍拜占庭容错或崩溃容错协议，说明协议满足的四个要求，给出 N ≥ 3 f + 1 条件
   3. 介绍一种上述分布式系统的精密实现：分布式计算共识，据此引出共识正确性所要具备的两个要求：safety 和 liveness，实际中使用节点复制方案，尤其是状态机复试 SMR 方案，来满足这两个要求，接着说明了 SMR 的 3 个要求，其中第 2 个要求：全序广播，也称为原子广播，与可靠广播相反，后者无需要求每个节点执行请求的顺序也一致，原子广播等价于分布式共识，SMR 原理【1】
   4. 介绍了知名的共识协议：从同步和异步协议两方面来介绍，又将异步分为确定性终止和概率性终止，采取的内容组织结构：来源及原理+关键原理图表+容错条件/能力+消息传播复杂度/效率，对于特别重要的协议，还给出了其算法的伪代码【2】
   5. 对基于 BFT-SMR 的经典协议进行比较
4. 介绍基本的共识协议框架及设计目标，接着介绍 5 组件框架

   1. 区块链基础设施
      1. 网络：文中分为了许可制和无需许可制
      2. 交易：以比特币为例，主要说明了 UXTO 这一概念
      3. 数据结构：主要对链式结构作了介绍，还说明了链上记录了哪些数据
   2. 共识设计目标：4 个
   3. 区块链共识协议组件：5 个，给出每个组件的解释，并在传统 SMR 协议中找到对应，给出每个组件可供选择的选项，表 2
5. 介绍比特币中的共识协议及其相关概念、威胁和提升途径等

   1. 概括比特币共识：概率确定性，等价于异步系统的概率终止性
2. 比特币共识细节
   
   1. 设计原则，并给出了抽象的共识算法伪代码
   
   2. 分叉解决
   
   3. 安全分析，容错能力 50%
   4. 缺陷和威胁：性能与安全的权衡、能源效率低、日蚀攻击、自私挖矿、矿池与中心化风险
   5. 改进：介绍了两种对中本聪共识协议的改进
   6. PoW 结合 BFT 的几种协议介绍
6. 系统介绍了 PoS：从经济学角度，PoS 将矿工的机会成本从系统外部转移到了系统内部，根据节点持有的权益大小决定其提出一个区块的机会大小，
   1. 将 PoS 协议分为 4 类：chain-based PoS, committee-based PoS, BFT-based PoS, and delegated PoS (DPoS)，图 7 给出了每个类别的具体协议、时间和编号，并根据一些方面对这些具体协议进行了分类【3】
   2. 根据每个类别及其示例展开介绍，内容组织结构：此类别协议通用的抽象算法伪代码+属于此类的具体协议介绍+安全分析
   3. PoS 威胁：6 个 【4】
7. 介绍特定应用场景下的非主流共识协议：内容组织结构：整体介绍+安全分析，并给出每个类别的子类别和具体协议实现，对于部分具体协议还给出了抽象算法伪代码
   1. PoA
   2. PoET
   3. PoTS
   4. PoR
   5. RCPA
   6. BlockDAG-based Consensus Protocols
   7. TxDAG-based Consensus Protocols
8. 比较所有协议，总结它们的设计哲学/思想
   1. 对上文中介绍的部分重要主流协议在性能（网络规模扩展性和吞吐量方面）进行对比：图 11
   2. 给出上文中介绍的全部共识协议的综合对比表格：表 3
   3. 总结设计思想
9. 讨论共识协议设计的范式，给出一个简洁的教程：【5】
10. 总结全文

## 思路

1. 作为针对于区块链网络中共识协议的综述，本文对相关定义和关键结论的论述十分详细全面且深入，大量使用了数学符号语言来介绍协议原理，使得所介绍的内容更加透彻，但是读来有些困难

2. 文中对具体协议的介绍都采取了如下的内容组织结构：原理+关键原理图表+性能评价和安全分析+抽象算法伪代码，其中根据协议重要程度会省略一些结构，如图表、伪代码等，并且在最后都会对协议做综合的对比

3. 对所要介绍的方面层层划分类别，并且对每一个最底层的类别都结合具体实现和示例来论证，使得文章内容更加的深入、可信，如在对知名共识协议介绍时：先从同步和异步协议两方面来介绍，在将异步分为确定性终止和概率性终止，每个类别下则直接罗列属于此类的具体协议，并按照上述对具体协议介绍的组织结构进行介绍

4. 文章介绍的内容由浅入深，层层递进，十分全面，逻辑清晰，比如对经典拜占庭容错系统介绍的部分：

   > 从经典消息传递系统模型
   >
   > ->引出 FLP 不可能性原理
   >
   > ->提出规避这种不可能的途径（下文中的异步共识协议）
   >
   > ->再介绍 BFT 模型，将经典消息传递模型上升为更为精细的计算共识系统模型
   >
   > ->从而引出 safety 和 livness 两个保证共识正确性要求
   >
   > ->再从解决这两个要求的思路，过渡到 SMR 方案
   >
   > ->又根据 SMR 要求的全序广播（原子广播）推广，得出原子广播等价于分布式共识的结论
   >
   > ->最后介绍并比较了结合了 SMR 和 BFT 的具体共识协议（分为同步和异步）

## 方法

1. 划分类别+子类别，最底层类别结合具体实现来介绍
2. “原理+图表+性能评价和安全分析+算法伪代码” 论述结构
3. 共识协议 5 组件框架，但是文中只是简略的介绍，没有将框架应用到具体的协议介绍中

## 要点

1. 经典的分布式共识协议介绍，此部分是区块链网络共识协议的基础
2. 在经典共识协议基础上，对区块链共识协议框架及设计目标做了介绍，给出 5 组件框架
3. 以比特币为例，进一步介绍区块链网络中的共识协议及其与经典共识的不同和发展
4. 对具体协议的介绍，包括知名共识协议、PoS 类别中对应的具体协议实现、其它非主流协议
5. 对上文协议的比较结果
6. 设计共识协议的范式

## 结论

1. 在总结经典容错系统基础上，对区块链共识协议进行了全面的回顾，在容错、性能、安全等方面分析了每个协议，强调每一种协议的具体实现
2. 提出 5 组件共识协议框架，及共识协议设计范式

## 对比

1. 本文在划分协议类别的基础上，强调每一种协议的具体实现，大部分篇幅用于叙述协议的实现原理，介绍的内容相比前两篇文章更加深入。
2. 内容的逻辑很清晰，层层递进，大多数关键理论的介绍都是从理论起源一直介绍到具体实现
3. 而与第一篇论文的过于拘泥于方法论相比，本文对于方法论的介绍过于简略，其提出的 5 组件框架只用了一个小节就草草带过，且没有将其应用于解构文中介绍的共识协议，少了很多说服力，文末最后的范式也缺少了实际操作的示例
4. 从整篇文章的结构来看，虽然详细的内容介绍逻辑清晰，但是全文的结构组织有些混乱，如经典容错模型一章中夹杂了 BFT 及基于 BFT-SMR 协议的介绍，而 PoS 却作为单独一章，且 PoW 的介绍只依托于比特币这一个具体示例，但是 BFT 和 PoS 提供了很多的具体实例，个人觉得，论文结构稍有松散，如果进行适当的拆分应该更好
