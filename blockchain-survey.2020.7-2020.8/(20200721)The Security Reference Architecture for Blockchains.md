[1]: [The Security Reference Architecture for Blockchains-Towards a Standardized Model for Studying Vulnerabilities, Threats, and Defenses](http://arxiv.org/abs/1910.09775)

“【】”符号及数字表示此内容需要深入学习

## 主题

提出一种安全参考架构，用于研究区块链漏洞、威胁及防御的对策和技术等，系统化区块链安全和隐私方面的知识，为标准化作出贡献。

模型利用层次模型，演示了各种安全和隐私威胁的性质和等级。

模型包括四层：网络层、共识层、复制状态机层、应用层。判断每层中潜在的安全威胁及其来源，并给出对应缓解该威胁的技术或对策。

随后，给出面向区块链及相关技术的调查和应用。

## 结构

1. 介绍
   - 区块链越来越流行，因此需要安全的，弹性的网络结构、稳健的共识协议、安全的应用程序构建环境。
   - 安全性很重要，是区块链取得成功的关键，但是由于它的复杂和新颖，安全评估，相比其他传统分布式应用，要更加全面。
   - 目前没有已实施的通用的区块链安全模型，缺少一个平台无关的全面的区块链安全标准，全面指的是在实现、互操作性、服务、应用及分析方面。
   - 不仅列举安全问题，而且讨论这些问题的根源，同时列出可能的缓解潜在威胁的对策和技术，提出区块链安全参考架构，类似于 ISO/OSI 的层次模型。
   - 通过将上述的层次模型混合入 IEC 标准中，丰富了安全评估标准 ISO/IEC 15408，使之适配区块链的基本架构。
   - 介绍了在近期工作的基础上修改和扩展的内容
   - 论文结构介绍，以节为单位（见下文）
   
2. 所做的工作，方法论：

   - 从各个渠道搜集面向区块链安全的文献资料，将其整合，对收集到的缺陷和威胁进行分类（4 种主要类别，也可称为层），还划分了部分子类别，并试图从属于相同或不同类别的威胁中提取出相关联的部分
   - 研究范围：只关心区块链系统的核心要素方面的安全问题，不会接触区块链及区块链应用相关基础设施之外的安全问题

3. 区块链系统的背景简单介绍：

   - 参与者：根据本地节点（参与者）的操作，可以将其划分为三类，并构成一个层次模型，图一

     - 共识节点：共识协议的基础，向块内读取写入交易，验证检查交易有效性，通过拒绝写入无效交易或不接入恶意节点分叉来预防恶意行为，在投入资源证明共识协议（PoR）中，共识节点还可称为矿工
     - 验证节点：验证节点与共识节点不同的是，它不能向区块写内容
     - 轻节点：获取有限的区块信息（大多数情况为块头信息），通常只可以检测验证与自己相关的交易
     - 其他参与者：与本地节点不同，为区块链提供其它服务，如数据存储、钱包托管等，见 8  节和 9 节

   - 特性：分为固有的和非固有的，结合共识协议来介绍

     - 固有：去中心、不可篡改、可用、可审计。透明
     - 非固有：能源效率（存在不浪费资源的共识协议——PoB 或 PoS）、可扩展（行为与参与者数目无关的共识协议所具有的性质）、吞吐量（如 PBFT，可大大提供系统吞吐量，它只有少量的参与者）、隐私和匿名、可溯源和不可抵赖

   - 种类：按许可类型分类

     - 无需许可：为了防止女巫估计，采用投入资源证明共识协议
     - 需要许可：节点由中心或者联盟组织授权加入区块链，链可以公有也可以私有
     - 半许可：与无需许可的链类似，节点加入时需要获得某种形式的许可，而不同的是，这种形式的许可可以由任意一个共识节点授予，基于权益证明共识协议（PoS），投入或持有量越大，共识的权力也越大

   - 共识协议设计目标：分为通用目标和特定链类型、场景下的目标

     **通用目标**

     - liveness——活跃度：保证交易被处理验证，并传送到其他节点
     - safety——安全性：常常使用术语 finality——确定性和 time to finality——确定时间，即确认机制，在一个区块后连接了一定数量的区块之后，才可以认为这个区块是安全的，比特币的 PoW 共识中，这个数字是 6，也可称之为 6 个确认，在 BFT 共识中，达到确定只需等待一个确认。以上情况都是基于对恶意节点掌握的资源等不会超过一个比例的阈值，如 PoW 的 51%，BFT 的 66.7%

     **特定目标**

     - 无需许可类型：消除女巫攻击、共识节点对共识结果的影响与其投入的资源数量相匹配、节点在验证共识结果时无需交互
     - 需要许可和半许可类型：需要一个公正的领导者或组织，对共识进行非交互的验证，无需考虑防范女巫攻击
     - 可验证随机函数仿真：【1】
     - 激励和奖励方案：刺激共识节点诚实地参与，公链/无需许可环境下采取出块奖励（作为区块的第一笔交易，还称为铸币交易）+交易费的形式。激励机制多用于公链。不恰当的激励往往会导致共识层面的漏洞

   - 共识协议基础：两种类型

     - 基于运气/概率的共识协议：网络流量需求少，高可扩展，会产生分叉（两种分叉选择规则：最长链原则、最强链原则），此类协议处理分叉会增加确定时间
     - 基于投票的共识协议：由于几乎不会产生分叉，因而确定时间短，高吞吐量，但是扩展性相对较差，这体现了吞吐量与可扩展性的权衡
     - 结合体：为了提高可扩展性可以减少参与投票的共识节点数量，为了提高吞吐量可以将全部节点分组，来进行并行的投票

   - 共识协议中的“错误”模型：

     - 故障则停止错误：一个节点的错误行为被暴露给其它节点后，要么停止运行，要么继续执行操作
     - 拜占庭错误：失败节点可以表现出任意行为，这些行为可以是异常的，拜占庭错误对于以安全作为关键的应用来说，十分重要

4. 总体上介绍安全参考架构

   - 栈式模型：使用层次模型来分隔威胁及其性质，在应用层做了与众不同的分类，并对前三层几种特定类别的实现方式的利弊做了总结：表 1
     - 网络层：网络服务层（发现对等实体并与之通信、寻址、路由、命名服务）+数据表示（存储、编码、保护）
     - 共识层：处理交易订单，三类：拜占庭容错、投入资源证明、权益证明
     - 复制状态机层：【2】
     - 应用层：分为区块链生态系统（为高层区块链应用提供通用的功能，如钱包和交易所、预言机、文件系统、认证管理、安全时间戳等）、高层区块链应用，高层应用可从生态系统中继承其部分安全属性
   - 威胁风险评估模型：基于 ISO/IEC 15408
     - 所有者：运行任意类型节点的区块链用户，拥有加密令牌，可能使用或者提供以区块链为基础的服务
     - 资产：由货币价值（即区块链功能，及在其之上构建的应用层服务）组成，用户的真实性和隐私性，服务的可用性，也可被认为是应用层特定的资产。
     - 威胁源：既可以是恶意用户，也可以是无意的实体
     - 威胁：使资产变得易受攻击
     - 对策：保护所有者远离威胁
     - 风险：由威胁和威胁源引发，会导致资产的流失
     - 接着按层次简要介绍了每一层的可能威胁源及对策
     - 强调区块链的设计开发者也应该别视为潜在的威胁源

5. 网络层：分为公网和私网，由数据表示区（使用加密算法，保证数据完整性，用户可认证性，可选的机密性、隐私性、匿名性、不可抵赖性及可溯源性）和网络服务层（提供对等实体管理和发现等面向区块链的服务）组成

   - 私网/内网：
     - 介绍：确保了低延迟、集中管理、隐私性、满足法律法规，属于许可制区块链，私网可以在网络层提供认证和访问控制
     - 优点：1. 通过对用户集中身份验证，并授予角色，来实现访问控制，私网对路由路径和物理资源使用拥有完全的控制，能够根据给定得要求对网络拓扑和传输介质做出合适的调整；2. 许可制确保了数据的隐私性，通过细粒度的授权控制实现最小暴露的安全原则，用户的身份只会暴露给同一个私人组的节点；3. 资源可用性更容易管理和预见，因为已经了解所有的网络参与者和部署方案
     - 缺点：1. VPN 继承了服务运行于公共网络时所具有的缺点；2. 私网只适用于许可制和私人区块链
     - 安全问题及防护措施：图 6
   - 公网/互联网
     - 介绍：高度去中心化、开放性、准入门槛低，而网络延迟、隐私和访问控制则被搁置，无需许可的区块链都需要这类开放网络
     - 优点：1. 对于多宿主节点来说，高可用性意味着可以通过多条通道传递和发送消息，可以提高节点链接到区块链上的机会；2. 高度去中心化由节点在地理位置上的分散分布来达成；3. 开放性和低门槛是由于开放网络的广泛采用、技术的可操作性(如使用TCP/IP)、经济因素(如宽带连接的低成本)和社会因素(法律法规)，其中统计数据的共享有开放性是低准入门槛的基础
     - 缺点：1. DNS、IP 等网络设施由中心组织管理；2. 外部敌人带来的威胁（5 类）；3. 由于对等实体间的带宽大小不一，提升了延迟，降低了运行效率
     - 安全问题及防护措施：图 7，并在表 2 列举了一些安全突发事件

6. 共识层：三种共识协议，先概述共识中存在的通用安全问题，再针对每一种共识单独介绍优缺点、安全问题及其对策 

   - 通用攻击：图 8
   - PoR
     - 介绍：略
     - 优点：证明方式更加公平
     - 缺点：概率性导致链会产生分叉，
     - 安全问题及防护措施：：图 9
   - BFT
     - 介绍：基于投票机制，利用拜占庭协议及状态机复制实现，假设处于一个全连通的拓扑，使用广播发送消息，【3】
     - 优点：高吞吐量、快速确定、扩展性较差，因此常和 PoW、PoS 结合，即采用从所有节点中选取一部分（PoW、PoS）再抽签（BFT）的办法
     - 缺点：由于通信复杂度（θ(n2)）导致的扩展性较差，协议只有在对参与节点数目进行限制后效率才有所提升，因此协议往往要以纯粹的形式在许可制区块链中运行；扩展性和吞吐量问题可以通过应用加密结构和分割共识节点并行处理交易的方式来缓解，还可以精简运行 BFT 的节点数量，虽然这会降低其安全性
     - 安全问题及防护措施：图 10
   - PoS
     - 介绍：节点通过投资证明的方式参与协议，通过投资赚取利息；概念产生于比特币论坛，首次在 peer coin 中实现，结合了 PoS 和 PoW，基于 PoW 进行铸币，基于 PoS 维护网络安全；将 BFT 和 PoS 结合起来，可以兼顾两者的优势
     - 优点：能源效率高，无需消耗或少量消耗稀缺资源
     - 缺点：基于 PoS 的协议没有被正式证明是安全的；半许可制，一个节点需要从其他节点得到投资才可参与协议
     - 安全问题及防护措施：图 11
   - 突发安全事件：表 3

7. 复制状态机层：负责解释和执行共识层处理好的交易，这一层的威胁主要与用户隐私、数据机密性和隐私、智能合约相关缺陷有关；可分为两部分

   - 第一部分：处理交易，交易是任意类型参与方进行数字签名之后的消息，经过成功验证和收取手续费之后，交易会被添加到区块链中
   - 第二部分：处理一种特殊的交易，智能合约——一段预先确定的程序代码，运行于区块链上
   - 交易保护：对于监听交易消息的监听者，最多只能追溯到一个具有真实 IP 的匿名身份，这无法保证交易信息的机密性，因此一些文献提出了在区块链中嵌入对数据和用户隐私的保护机制，这些机制也可由应用层提供，但是会增加开销，安全问题及防护措施：图 12
   - 智能合约：分为图灵完备和图灵不完备两种类型的编程语言，安全问题及防护措施：图 13
   - 突发安全事件：表 4

8. 应用层的生态系统：5 类

   - 加密令牌和钱包：秘密信息的安全存储，安全问题及防护措施：图 15
   - 交易所：保证用户与其它用户的交易安全，安全问题及防护措施：图 16
   - 预言机：保证区块链应用与区块链外部世界的数据传递及安全，安全问题及防护措施：图 17
   - 文件系统：区块链应用数据的永久保存，在完全复制一个区块链时，数据不应再次本地存储，文件系统要提供其它替代方案，安全问题及防护措施：图 18
   - 认证管理：通过实体的公钥，为其分配名称/身份，安全问题及防护措施：图 19
   - 安全时间戳：区块链提供通过存储数据的哈希来为其标记时间戳的能力，安全问题及防护措施：图 20

9. 应用层的高层应用：7 类

10. 讨论与所做工作的局限性：概况与区块链相关的其它安全威胁和工作（语法/语义漏洞、安全加密原语），对于继承了多各类别的安全方面的应用程序，文中没有进行介绍，文中一些类型的攻击在实践中还没有被证实会发生，但是随着区块链技术的发展，这些攻击一定会发生

11. 与其他相关工作做比较：扁平化分类、层次分类或针对特定层次/领域

12. 总结全文

## 思路

- 本文在对所有内容进行介绍时，都进行了细致合理的分类，如对区块链背景介绍时，将参与者分为 3 类、将特性分为 2 类、将区块链系统分为 3 类、将区块链设计目标分为 2 类。在对内容分类的基础上，层层递进，继续划分子类别，达到对内容深入介绍的目的。
- 作为一篇综述，本文力求以更加通用的描述语言来对区块链的基本概念、安全体系结构等进行介绍
- 采取层次思想，并按照层次顺序，从下层到高层，依次对区块链的安全体系结构进行介绍。先对每一层次的构成进行分类，如网络层分为公网和私网、共识层分为 PoR、BFT、PoS等，对层次中的每一个类别（方案）都采用 “1. 介绍；2. 优点；3. 缺点；4：安全威胁/来源/对策” 四个步骤依次介绍，其中对于一些类别还划分了子类别
- 在每一小节或者一小部分叙述之后，都会根据介绍的内容给出内容的图表，十分清楚明了

## 方法

- 划分类别+子类别
- OSI 层次模型
- “1. 介绍；2. 优点；3. 缺点；4：安全威胁/来源/对策” 四部曲

## 要点

- 使用栈式/层次模型介绍区块链的安全参考架构
- 架构中的每一个层次及组成结构的每一个类别对应的威胁/来源/对策
- 其中将应用层分为两节分别介绍生态系统和高层应用，使得逻辑更加清晰

## 结论

系统地介绍了区块链及相关的安全体系，给出了一个可用于区块链威胁风险评估模型，提出了一种区块链的安全参考架构。

## 对比

1. 相比上一篇综述，本文介绍的区块链基本概念更加通用，且深入
2. 没有过分执着于方法论，文章重点放在了内容的组织和介绍之上
3. 类别+子分类+层次结构等文章组织方式，使得综述的逻辑更加清晰，读完豁然开朗
4. 介绍的内容十分全面，但是又是都针对于文章的主题——区块链安全架构
5. 介绍的内容也很深入，特别地，对于文章无法展开介绍的内容，如流行共识协议具体详情的介绍等等，作者都给出了推荐阅读的参考文献
6. 美中不足的是，文中缺少了一些对于未来研究的展望和建议