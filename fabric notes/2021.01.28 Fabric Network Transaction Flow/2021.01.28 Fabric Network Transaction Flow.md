# Fabric Network: Transaction Flow

## Content

[TOC]

## XXX

**闭关写医疗数据共享和溯源系统**

之后的交易流程和开发流程都基于此来进行。

【应用场景图】：包括公有和私有

【流程图】

按照流程，介绍角色和每个流程所完成的工作

【泳道图】

给出泳道图

【子流程图】

根据前一个流程中出现角色的顺序，为每个角色绘制子流程图

详细介绍角色的职责和事件

【子泳道图】

同上，给出子泳道图

## 笔记

![flow-simple](res/2021.01.28%20Fabric%20Network%20Transaction%20Flow/flow-simple.png)

根据[官方文档](https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/txflow.html)的流程，梳理简化叙述一遍，圈出重点:

- 交易提案结构
- SDK 打包后结构
- 背书节点如何验证交易提案之前没有被提交过（重放攻击保护）
- 签名有效性如何验证
- 提案发起者权限如何验证
- “也就是说，每个背书节点确保发起者满足通道 *Writers* 策略” 是什么意思
- 链码函数参数长什么样
- “根据当前状态数据库执行链码，生成交易结果，包括响应值、读集和写集（即表示要创建或更新的资产的键值对）” 中如何执行、交易结果长什么样、响应值都包括什么、读写集是什么，都有什么作用
- 提案响应的格式
- 如果恶意客户端一直散布未背书的交易怎么办，会不会影响网络性能
- 排序节点，排序时对于来自不同通道的交易如何处理；对于来自同一通道的多个交易如何处理，排序策略是如何生效的。“排序服务只是从网络中的所有通道接收交易，将它们按时间按通道排序，并将每个通道的交易打包成区块。”
- 区块如何传播到 peer，传播到哪些 peer，peer 对区块都进行哪些验证，验证无效的交易怎么办，也存到区块链吗，之后的区块怎么办
- 账本更新包括哪些流程，顺序如何，如何通知给其它节点和客户端等更新完毕了

根据流程对重点进行解说

- 如何理解 “智能合约和账本将网络中共享的*流程*和*信息*对应地封装起来。”

最后再把整个流程串一遍

