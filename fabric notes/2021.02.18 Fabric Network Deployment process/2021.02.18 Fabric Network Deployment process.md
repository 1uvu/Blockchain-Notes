# Fabric Network: Deployment Process

## Content

[TOC]

## 官方文档阅读顺序



## 逻辑架构

**Fabric四大核心组件：**

1. **Membership Services：**成员管理保证了Fabric平台访问的安全性。提供了成员的注册、管理及审核功能。

2. Blockchain Services：

   是区块链的核心部分，为区块链的主体功能提供了底层支撑；包括共识管理、分布式账本实现、账本的存储以及网络中各节点之间的通信实现。

   - **BlockChain：**区块之间以Hash连接为结构的交易日志。peer从order service接收交易区块k，并根据背书策略和并发冲突标记区块上的交易是否有效，然后将该区块追加到peer文件系统中的Hash Chain上。

   - Transaction：

     交易有对链码的部署或调用两种操作类型：

     - 部署交易：部署是请求在peer上启动链码容器；创建新的链码并设置一个程序作为参数。当一个部署交易执行成功，表明链码已被安装到区块链上。
     - 调用交易：调用是从账本中请求读写集。是在之前已部署链码的情况下执行一个操作。调用交易将使用链码提供的一个函数。当成功时，链码执行特定的函数对账本数据进行操作（修改状态），并返回操作结果。

3. Chaincode Services：

   提供了链码的部署及运行时的所需环境。

   - Chaincode：是一个可以对账本数据进行操作的可开发的组件程；链码被布署运行在一个安全的容器中；用户可以通过调用链码中的指定函数对账本数据进行修改或读取操作。

4. **Event：**为各组件之间提供异步通信提供了技术实现。

## 运行时架构

【略】

## 核心配置文件

网络开发步骤其实就是写配置文件的步骤：根据设置选项自动生成配置文件

`core.yaml`

> 与 Peer 相关。peer 节点和 P2P 网络相关的配置文件

`crypto-config.yaml`

> 与 CA 相关。与组织结构及身份证书关联的配置文件

cryptogen generate --config=./crypto-config.yaml

证书和密钥（即MSP材料）将被输出到当前一个名为 `crypto-config` 的目录中，该目录下有两个子目录：

- **ordererOrganizations** 子目录下包括构成 Orderer 组织(1个 Orderer 节点)的身份信息

- **peerOrganizations** 子目录下为所有的 Peer 节点组织(2个组织，4个节点)的相关身份信息. 其中最关键的是 MSP 目录, 代表了实体的身份信息

`configtx.yaml`

> 与 TX 相关。创建服务、启动初始区块及应用通道交易时，在这个配置文件中指定 Orderer 服务的相关配置和当前的联盟（组织）信息

`docker-compose-*.yaml`

> 与容器相关：ca、network、couchdb 等的容器环境配置

`orderer.yaml`

> 与 Orderer 相关。当使用了 solo 时，由于配置简单，都在 core 里面了，所以无需额外配置这个文件。而当使用其它排序策略时则需要配置。







