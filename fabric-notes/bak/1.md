## 交易流程



## 数据隔离：Channel != Sharding（分片）

#### 系统通道



#### 用户通道

跨通道合约调用只能读不能写

## 背书策略

P = {AND(P1, P2), OR(P1, P2), OutOf(m, P1, P2, ..., Pn) m <= n}

P 指的是策略, 由最基本的三种策略组成。

OR 策略要慎重选择，有一方作恶就完了。

实例化链码时，都要指定其背书策略，如：AND(OrgA, OrgB)，因此需要 A，B 都需要部署这个链码。

## Peer

角色-账本和状态数据库-链码-Gossip（leader-传播区块给随机的peers and anchor-相当于peer的路由器 需要详细了解）-Private data（再说吧）

账本和链码的载体，向客户端应用发出事件

‮ ‮ 2020/12/15 15:45:10
排序执行，排序验证，分阶段提交

‮ ‮ 2020/12/15 15:51:29
几类节点角色包含层次图(单独出一个导图)

‮ ‮ 2020/12/16 10:27:17
交易流程：client 通过 cli 或 sdk 发送，并根据交易提案选择目标背书节点，然后向其发送交易提案；
背书节点收到提案后，按照交易提案中的交易请求调用相应的链码，得出结果（读写集，读集和写集分别是什么），返回背书节点的签名（对读写集的签名），还包括是否同意交易的信息（什么格式暂不知道）；
客户端验证返回的背书结果是否符合背书策略，是否一致等，符合则将交易（读写集）发送给排序节点，这些验证也可不做；
排序节点根据排序策略对交易排序，打包，分发给提交节点；
提交节点验证区块中的交易（读写集），因为这个过程是异步的，所以会对这个读写集的一致性进行验证，解决了双花问题，成功则提交，失败则拒绝。

‮ ‮ 2020/12/16 10:33:56
通道图加上组织

‮ ‮ 2020/12/16 10:59:45
角色职责事件树形组织，有交叉用箭头0

区块结构图